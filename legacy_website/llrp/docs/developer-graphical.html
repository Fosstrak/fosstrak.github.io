<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Fosstrak LLRP Commander - Developers guide - Graphical Editor</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
      </head>
  <body class="composite">
    <div id="banner">
                  <a href="../" id="bannerLeft"  >
    
                                            <img src="../images/banner_left.gif" alt="Fosstrak" />
    
            </a>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
    
  
    
            <div class="xleft">
      <!--
        Version: 1.1.1-SNAPSHOT
	-->
                     
                <a href="../../index.html">Fosstrak</a>
                &gt;
      
                <a href="../">LLRP Commander</a>
                          </div>
            <div class="xright">            <a href="../../epcis/index.html">EPCIS Repository</a>
            |
                <a href="../../tdt/index.html">TDT Engine</a>
            |
                <a href="../../fc/index.html">ALE Middleware</a>
            |
                <a href="../index.html">LLRP Commander</a>
            
  

  
    
    
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
    
  
    
                   <h5>LLRP Commander</h5>
            <ul>
              
    <li class="none">
                    <a href="../index.html">Overview</a>
          </li>
              
    <li class="none">
                    <a href="../features.html">Features</a>
          </li>
              
    <li class="none">
                    <a href="../download.html">Install</a>
          </li>
              
    <li class="none">
                    <a href="../background.html">Background</a>
          </li>
              
    <li class="none">
                    <a href="../license.html">License</a>
          </li>
              
    <li class="none">
                    <a href="../mail-lists.html">Mailing Lists</a>
          </li>
              
    <li class="none">
                    <a href="../issue-tracking.html">Issue Tracking</a>
          </li>
          </ul>
              <h5>Guides and Documentation</h5>
            <ul>
              
    <li class="none">
                    <a href="../docs/user-index.html">User Guide</a>
          </li>
              
          
                    
                  
                        
                  
                  
                  
                  
                        
                  
                  
                  
                        
                  
              
        <li class="expanded">
                    <a href="../docs/developer-index.html">Developer Guide</a>
                  <ul>
                  
    <li class="none">
                    <a href="../docs/developer-installation.html">Installation</a>
          </li>
                  
          
                          
                  
                  
                  
                  
              
        <li class="expanded">
                    <a href="../docs/developer-gui.html">GUI</a>
                  <ul>
                  
    <li class="none">
              <strong>Graphical Editor</strong>
        </li>
                  
    <li class="none">
                    <a href="../docs/developer-xml.html">XML / Binary Editor</a>
          </li>
                  
    <li class="none">
                    <a href="../docs/developer-navigator.html">Navigator</a>
          </li>
                  
    <li class="none">
                    <a href="../docs/developer-explorer.html">Reader Explorer</a>
          </li>
                  
    <li class="none">
                    <a href="../docs/developer-wizard.html">Wizard</a>
          </li>
              </ul>
        </li>
                  
          
                    
                  
                  
              
        <li class="expanded">
                    <a href="../docs/developer-mgmt.html">Management</a>
                  <ul>
                  
    <li class="none">
                    <a href="../docs/developer-adaptormanagement.html">Adaptor Management</a>
          </li>
                  
    <li class="none">
                    <a href="../docs/developer-adaptors.html">Adaptors</a>
          </li>
                  
    <li class="none">
                    <a href="../docs/developer-readers.html">Readers</a>
          </li>
              </ul>
        </li>
                  
    <li class="none">
                    <a href="../docs/developer-repository.html">Repository</a>
          </li>
                  
    <li class="none">
                    <a href="../apidocs/index.html">JavaDoc</a>
          </li>
              </ul>
        </li>
          </ul>
              <h5>LLRP Commander Modules</h5>
            <ul>
              
                
                    
              
        <li class="collapsed">
                    <a href="../llrp-adaptor/project-reports.html">LLRP Adaptor</a>
                </li>
              
                
                    
              
        <li class="collapsed">
                    <a href="../llrp_commander/project-reports.html">LLRP Commander</a>
                </li>
          </ul>
                                                 
                        
                        
            <a href="http://www.autoidlabs.org/" title="Auto-ID" class="poweredBy">
                            <img  class="poweredBy"  
                    alt="Auto-ID" 
                    src="../images/logos/supportedByAutoid4.png" 
                    width="90"
                    height="30"
              />
            </a>
                               
  

  
    
    
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Developers guide - Graphical Editor</h2><div class="section"><h3>Content</h3><ol type="1"><li><a href="#Overview">Overview</a> </li><li><a href="#GUI Classes">GUI Classes</a></li><li><a href="#Utility Classes">Utility Classes</a></li><li><a href="#References">References</a></li></ol></div><div class="section"><h3><a name="Overview">Overview</a></h3><p>This chapter speaks about the design of the graphical editor. The following diagram gives you an overview of its architecture:</p><img src="../images/developer/graphical_editor_architecture.png" /></div><div class="section"><h3><a name="GUI Classes">GUI Classes</a></h3><p>The graphical editor is realized using <a href="http://www.eclipse.org/articles/Article-Forms/article.html">Eclipse Forms</a>. It implements the &quot;master/details&quot; user interface design pattern. The &quot;master&quot; part consists of a tree that shows the structure of the message. The &quot;details&quot; part displays the fields and sub-parameters of the parameter that is currently selected in the master part.</p><p>For detailed information have a look at the following classes:</p><ul><li><tt>org.fosstrak.llrp.commander.editors.graphical.GraphicalEditorPage</tt></li><li><tt>org.fosstrak.llrp.commander.editors.graphical.LLRPMasterDetailsBlock</tt></li><li><tt>org.fosstrak.llrp.commander.editors.graphical.LLRPDetailsPage</tt></li><li><tt>org.fosstrak.llrp.commander.editors.graphical.LLRPTreeContentProvider</tt></li><li><tt>org.fosstrak.llrp.commander.editors.graphical.LLRPTreeLabelProvider</tt></li><li><tt>org.fosstrak.llrp.commander.editors.graphical.actions.AddParameterAction</tt></li><li><tt>org.fosstrak.llrp.commander.editors.graphical.actions.DeleteParameterAction</tt></li></ul></div><div class="section"><h3><a name="Utility Classes">Utility Classes</a></h3><p>The classes described in this section are all used by the graphical editor, but in principle they are independent of the GUI classes and can be used irrespective of them (The class <tt>LLRPFactory</tt>, for example, is also used by the New Message Wizard). We are talking about:</p><ul><li><tt>org.fosstrak.llrp.commander.util.LLRPTreeMaintainer</tt></li><li><tt>org.fosstrak.llrp.commander.util.LLRP</tt></li><li><tt>org.fosstrak.llrp.commander.util.LLRPFactory</tt></li><li><tt>org.fosstrak.llrp.commander.util.LLRPConstraints</tt></li><li><tt>org.fosstrak.llrp.commander.util.LLRPPresenceConstraint</tt></li><li><tt>org.fosstrak.llrp.commander.util.LLRPRangeConstraint</tt></li><li><tt>org.fosstrak.llrp.commander.util.Range</tt></li></ul><div class="section"><h4>Underlying model</h4><p>As model classes for the graphical editor the classes of LTKJava are used (<tt>LLRPMessage</tt>, <tt>LLRPParameter</tt>, etc.). This is, the graphical editor works on a tree of LTKJava objects. The root of the tree is an object of type <tt>LLRPMessage</tt>, and has <tt>LLRPParameter</tt>s and lists of <tt>LLRPParameter</tt>s as children. As an example, consider the following picture that shows the (slightly simplified) object graph for a typical <tt>ADD_ROSPEC</tt> message:</p><img src="../images/developer/add_rospec_object_graph.png" /><p>We call the nodes of this graph <b>tree elements</b>. A tree element is either of type <tt>LLRPMessage</tt>, <tt>LLRPParameter</tt> or <tt>List&lt;LLRPParameter&gt;</tt>. Moreover, every tree element has 0 or more <b>fields</b>, 0 or more <b>children</b> (which can be null), and exactly 1 <b>parent</b> (the parent of the root is null). The tree element <tt>ROSpec</tt> (which is of type <tt>LLRPParameter</tt>), for instance, has 3 fields (<tt>ROSpecID</tt>, <tt>Priority</tt>, <tt>CurrentState</tt>), 3 children (<tt>ROBoundarySpec</tt>, <tt>SpecParameter</tt>, <tt>ROReportSpec</tt> (null)) and the tree element <tt>ADD_ROSPEC</tt> as parent.</p><p>Because LTKJava does not provide a method to get all children of a tree element, the children are retrieved indirectly by using information from <tt>llrpdef.xml</tt> [1], and <b>reflection</b>. For example, to get the children of the <tt>ROSpec</tt> parameter, the names of the children (ROBoundarySpec, SpecParameter, ROReportSpec) are learned by querying <tt>llrpdef.xml</tt>, and then the corresponding getter-methods of <tt>ROSpec</tt> (<tt>getROBoundarySpec()</tt>, <tt>getSpecParameterList()</tt>, <tt>getROReportSpec()</tt>) are called using reflection.</p><p>All functionality to navigate and modify the LTKJava object graph is encapsulated in the class <tt>LLRPTreeMaintainer</tt>.</p><p>The code to query the <tt>llrpdef.xml</tt> is contained in the class <tt>LLRP</tt> (to be precise: the class <tt>LLRP</tt> does not directly access <tt>llrpdef.xml</tt>, but uses helper classes of the <tt>LTKGenerator</tt> [2]).</p><p>[1] <tt>llrpdef.xml</tt> is the LLRP description in XML, see <a href="http://llrp-toolkit.wiki.sourceforge.net/LLRP+Protocol+Definition+(llrpdef.xml)"> http://llrp-toolkit.wiki.sourceforge.net/LLRP+Protocol+Definition+(llrpdef.xml)</a>.</p><p>[2] The LTKGenerator is the module that generates the LTKJava classes from <tt>llrpdef.xml</tt>.</p></div><div class="section"><h4>Validation functionality</h4><p>When a user edits a message in the graphical editor, he gets immediate feedback about the correctness of the message in form of error flags and error messages. This functionality is enabled by methods in the class <tt>LLRPTreeMaintainer</tt> that allow to validate fields and parameters (e.g. <tt>validateField(...)</tt> and <tt>validateChildPresence(...)</tt>).</p></div><div class="section"><h4>Additional LLRP constraints not modeled in llrpdef.xml</h4><p>The LLRP specification defines some constraints on fields and parameters which are not (yet) modeled in <tt>llrpdef.xml</tt>. For instance, it specifies that the field <tt>Priority</tt> of the <tt>ROSpec</tt> parameter must have a value between 0 and 7 (<b>Range Constraint</b>). Another example is that the sub-parameter <tt>PeriodicTriggerValue</tt> of <tt>ROSpecStartTrigger</tt> must be present when the field <tt>ROSpecStartTriggerType</tt> is set to <tt>Periodic</tt> (<b>Presence Constraint</b>). Because these constraints will probably get integrated into <tt>llrpdef.xml</tt> in the long term, it was not worth the effort to come up with our own data format to define these rules. To still provide the user as much help as possible to edit messages in the graphical editor, we currently just hard-coded these constraints in the Java code. For examples of how to specify such constraints have a look at the classes <tt>LLRPConstraint</tt>, <tt>LLRPRangeConstraint</tt> and <tt>LLRPPresenceConstraint</tt>.</p></div><div class="section"><h4>Information on messages and parameters</h4><p>In the graphical editor, the user can get a description of the currently selected parameter by clicking on the information icon. This functionality is realized by reading these descriptions from <tt>llrpdef.xml</tt> (see method <tt>getDescription(...)</tt> in class <tt>LLRP</tt>) and using the SWT browser widget to show the HTML content nicely formated to the user (see method <tt>createDescriptionAction()</tt> in class <tt>LLRPDetailsPage</tt>).</p></div></div><div class="section"><h3><a name="References">References</a></h3><ul><li><a href="http://www.eclipse.org/articles/Article-Forms/article.html">Eclipse Forms: Rich UI for the Rich Client</a> - Good article about Eclipse Forms.</li><li><a href="http://www.eclipse.org/articles/article.php?file=Article-Forms33/index.html">Eclipse Forms: New in 3.3</a> - Article about new Eclipse Forms features in Eclipse 3.3.</li><li><a href="http://www.eclipse.org/articles/Article-TreeViewer/TreeViewerArticle.htm">How to use the JFace Tree Viewer</a>.</li><li><a href="http://wiki.eclipse.org/JFaceSnippets">JFaceSnippets</a>.</li></ul></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2009
    
          
  

  
    
    
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
      </script>
      <script type="text/javascript">
      try {
      var pageTracker = _gat._getTracker("UA-9846531-1");
      pageTracker._trackPageview();
      } catch(err) {}
      </script> 
  </body>
</html>
