<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">










<html>
  <head>
    <title>Fosstrak Reader - Developer Change Log</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
          <meta name="author" content="Jonas Haller" />
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
      </head>
  <body class="composite">
    <div id="banner">
                  <a href="../" id="bannerLeft">
    
                                            <img src="../images/banner_left.gif" alt="" />
    
            </a>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
  
  
            <div class="xleft">
        Last Published: Oct 20, 2008 05:34:28 CEST
                          |   
          <a href="../../index.html">Fosstrak</a>
              &gt;
      
          <a href="../">Reader</a>
                        </div>
            <div class="xright">      <a href="../../index.html">Fosstrak</a>
          |
          <a href="../index.html">Reader</a>
          |
          <a href="../../fc/index.html">Filtering and Collection</a>
          |
          <a href="../../epcis/index.html">EPCIS</a>
          |
          <a href="../../tdt/index.html">Tag Data Translation</a>
          |
          <a href="../../hal/index.html">HAL</a>
          
  

  
    
  
  
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
  
  
                   <h5>Fosstrak</h5>
        <ul>
              
    <li class="none">
              <a href="../../index.html">Home</a>
        </li>
          </ul>
          <h5>Reader Project</h5>
        <ul>
              
    <li class="none">
              <a href="../index.html">Overview</a>
        </li>
              
    <li class="none">
              <a href="../features.html">Features</a>
        </li>
              
    <li class="none">
              <a href="../demo.html">Demo</a>
        </li>
              
    <li class="none">
              <a href="../download.html">Download</a>
        </li>
              
    <li class="none">
              <a href="../license.html">License</a>
        </li>
              
    <li class="none">
              <a href="../faq.html">FAQ</a>
        </li>
              
    <li class="none">
              <a href="../howtohelp.html">How to help</a>
        </li>
              
    <li class="none">
              <a href="../team-list.html">Project Team</a>
        </li>
              
    <li class="none">
              <a href="../mail-lists.html">Mailing Lists</a>
        </li>
              
    <li class="none">
              <a href="../issue-tracking.html">Issue Tracking</a>
        </li>
              
    <li class="none">
              <a href="../source-repository.html">Source Repository</a>
        </li>
          </ul>
          <h5>Guides &amp; Documentation</h5>
        <ul>
              
          
              
      
            
      
            
      
            
      
              
        <li class="expanded">
              <a href="../docs/user-index.html">User</a>
                <ul>
                  
    <li class="none">
              <a href="../docs/user-core.html">Core</a>
        </li>
                  
    <li class="none">
              <a href="../docs/user-proxy.html">Proxy</a>
        </li>
                  
    <li class="none">
              <a href="../docs/user-client.html">Client</a>
        </li>
                  
    <li class="none">
              <a href="../docs/user-changelog.html">User Changlog</a>
        </li>
              </ul>
        </li>
              
          
              
      
            
            
              
            <li class="expanded">
              <a href="../docs/developer-index.html">Developer</a>
                <ul>
                  
    <li class="none">
              <a href="../docs/developer-guide.html">Developer Guide</a>
        </li>
                  
    <li class="none">
              <strong>Developer Changelog</strong>
        </li>
              </ul>
        </li>
              
    <li class="none">
              <a href="../apidocs/index.html">JavaDoc</a>
        </li>
          </ul>
          <h5>Reader Project Modules</h5>
        <ul>
              
                
              
      
              
        <li class="collapsed">
              <a href="../reader-rprm-core/project-reports.html">RP/RM Core</a>
              </li>
              
                
              
      
              
        <li class="collapsed">
              <a href="../reader-rp-proxy/project-reports.html">RP Proxy</a>
              </li>
              
                
              
      
              
        <li class="collapsed">
              <a href="../reader-rp-client/project-reports.html">RP Client</a>
              </li>
          </ul>
                                             
                        
                        
            <a href="http://www.autoidlabs.org/" title="Auto-ID" id="poweredBy">
                            <img alt="Auto-ID" src="../images/logos/supportedByAutoid4.png" />
            </a>
                               
  

  
    
  
  
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Developer Change Log</h2><div class="section"><h3>Changes</h3><ul><li><a href="#0.4.0">Release 0.4.0</a><ul><li><a href="#1605109">Bugfix 1605109</a>: Start reader from ReaderDevice class</li><li><a href="#1547804">Bugfix 1547804</a>: Cleaned up properties files</li><li><a href="#1524549">Bugfix 1524549</a>: Source properties added to ReaderDevice.xml</li><li><a href="#1760340">Bugfix 1760340</a>: Removed spinlock and redesigned continuous notification trigger with wait/notify</li><li><a href="#1524548">Bugfix 1524548</a>: Send notifications as HTTP posts</li><li><a href="#1519656">Bugfix 1519656</a>: Search for '&lt;?xml' instead of '&lt;' only to identify start of XML in notification</li><li><a href="#1770773">Bugfix 1770773</a>: JAXB context and marshaller stored static and initialized only once</li><li><a href="#1547776">Bugfix 1547776</a>: Added configuration file for the proxy</li><li><a href="#1773821">Bugfix 1773821</a>: Fixed field name, event and tag field values for custom data selector</li><li><a href="#1723152">Bugfix 1723152</a>: Renamed TagSelector shorthand from RF to TS</li><li><a href="#1782301">Bugfix 1782301</a>: Return error if 'ms=' missing in timer trigger value</li><li><a href="#1782482">Bugfix 1782482</a>: Return notification channel port number correctly</li><li><a href="#1547832">Bugfix 1547832</a>: Redesigned resource loading</li><li><a href="#1783839">Bugfix 1783839</a>: Send and receive handshake in core and proxy/client</li><li><a href="#1800577">Bugfix 1800577</a>: Added possibility to start multiple readers on a single computer</li><li><a href="#1823580">Bugfix 1823580</a>: No default configuration files defined in other configuration files</li><li><a href="#1826817">Bugfix 1826817</a>: Iterate over tag field names instead of field names when adding tags to a report in the source</li><li><a href="#1827468">Bugfix 1827468</a>: Rewritten byte array to hexadecimal formatted string converter function in the HexUtil class</li><li><a href="#1827498">Bugfix 1827498</a>: Interprete offset and length of a tag field as bits</li></ul></li></ul></div><div class="section"><h3>Release <a name="0.4.0">0.4.0</a></h3><div class="section"><h4>Bugfix <a name="1605109">1605109</a>: Start reader from ReaderDevice class</h4><p>The Fosstrak Reader had its main method in the message layer although the <tt>ReaderDevice</tt> class is the 'center' of the reader and should contain the main method.</p><p>A new main method was added to the <tt>ReaderDevice</tt> class. Additionally the new main method can take an argument containing path and name of a configuration file instead of allways using a hard coded configuration file name.</p></div><div class="section"><h4>Bugfix <a name="1524549">1524549</a>: Source properties added to ReaderDevice.xml</h4><p>The <tt>Source</tt> class was initialised with hard coded properties.</p><p>All the adjustable values have been written into a properties file and loaded in the initialisation routine of the <tt>Source</tt>. The properties have been integrated into the ReaderDevice configuration file in the meantime (see <a href="#1547804">1547804</a>).</p></div><div class="section"><h4>Bugfix <a name="1547804">1547804</a>: Cleaned up properties files</h4><p>There were a number of different properties files. It was unclear which of them currently were in use.</p><p>All the properties files were in use but their organisation was unclear. The configuration files have been cleaned up. In the ReaderDevice configuration file, which was formatted in XML, some values were hidden in element names. These values have been moved into elements and given expressive names. The messaging.properties and source.properties have been converted from properties to XML format and merged into the ReaderDevice configuration file.</p></div><div class="section"><h4>Bugfix <a name="1760340">1760340</a>: Removed spinlock and redesigned continuous notification trigger with wait/notify</h4><p>The continuous notification thread caused a spin lock which unnecessarily used a significant amount of system resources. It checked nonstop whether there were new notifications in the buffer to be sent. System resources were not even released between two checks to give another thread the possibility to receive and add a new notification to the buffer.</p><p>To eliminate this spin lock, a simple observer design pattern with the built-in wait and notify thread functionality of Java is used. The continuous notification thread blocks (wait) until the notification channel receives a new notification to be sent and awakes (notifiy) the trigger thread.</p></div><div class="section"><h4>Bugfix <a name="1524548">1524548</a>: Send notifications as HTTP posts</h4><p>Delivering notifications over the HTTP protocol was done using the same methods as when responding to commands on the command channel. For this reason the notifications were sent as HTTP responses, nota bene without a preceding HTTP request. This is obviously wrong and an application server receiving the notification is unable to handle it, because it can not send a response to a response.</p><p>The outgoing message dispatcher has been adjusted to handle notifications separately. It gets the target address from the socket and sends the notification as HTTP post.</p></div><div class="section"><h4>Bugfix <a name="1519656">1519656</a>: Search for '&lt;?xml' instead of '&lt;' only to identify start of XML in notification</h4><p>Sometimes the parser in the notification channel end point of the proxy was not able to parse a notification and throwed an exception. The reason was that the detection of the beginnig of the XML code failed and an invalid XML document was passed down to the parser.</p><p>A small number of other characters prefix the XML notification data. As the beginning of the XML data, the first '&lt;' character was taken. This failed if one of the preceding characters coincidentally was a '&lt;' character. To circumvent this problem the data received is searched for the string '&lt;?xml' to find the correct beginning of the XML data.</p></div><div class="section"><h4>Bugfix <a name="1770773">1770773</a>: JAXB context and marshaller stored static and initialized only once</h4><div class="section"><h5>Situation before fixing</h5><p>Every time the JAXB context was used a new instance was created. So every time a command or notification was marshalled or unmarshalled the whole Java XML Binding was recreated. This was very time consuming and not necessary. The following table shows a simple reader configuration with about ten commands and the amount of time used for the Java XML Binding.</p><p>Three methods use the JAXB context:</p><ul><li><b>sC</b>: <tt>serializeCommand()</tt> in the <tt>CommandSerializerImpl</tt> class of the proxy. Total includes marshalling.</li><li><b>gJC</b>: <tt>getJAXBContext()</tt> in the <tt>Context</tt> class of the core. Totel is the same as creating JAXB context.</li><li><b>nL</b>: <tt>notifyListeners()</tt> in the <tt>NotificationChannelEndPoint</tt> class of the proxy. Total includes mashalling.</li></ul><table class="bodyTable"><tbody><tr class="a"><td align="left"><b>method</b></td><td align="left"><b>creating JAXB context</b></td><td align="left"><b>total</b></td></tr><tr class="b"><td align="left">sC</td><td align="left">1280ms</td><td align="left">1311ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">562ms</td><td align="left">562ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">156ms</td><td align="left">156ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">125ms</td><td align="left">125ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">141ms</td><td align="left">141ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">78ms</td><td align="left">78ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">203ms</td><td align="left">203ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">47ms</td><td align="left">47ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">125ms</td><td align="left">125ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">94ms</td><td align="left">94ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">157ms</td><td align="left">157ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">63ms</td><td align="left">63ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">140ms</td><td align="left">140ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">94ms</td><td align="left">94ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">125ms</td><td align="left">125ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">156ms</td><td align="left">156ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">78ms</td><td align="left">78ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">47ms</td><td align="left">47ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">109ms</td><td align="left">109ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">46ms</td><td align="left">46ms</td></tr><tr class="b"><td align="left">nL</td><td align="left">344ms</td><td align="left">344ms</td></tr><tr class="a"><td align="left">nL</td><td align="left">31ms</td><td align="left">31ms</td></tr><tr class="b"><td align="left">nL</td><td align="left">47ms</td><td align="left">47ms</td></tr><tr class="a"><td align="left">nL</td><td align="left">47ms</td><td align="left">47ms</td></tr><tr class="b"><td align="left">nL</td><td align="left">62ms</td><td align="left">62ms</td></tr><tr class="a"><td align="left">nL</td><td align="left">62ms</td><td align="left">62ms</td></tr><tr class="b"><td align="left">nL</td><td align="left">47ms</td><td align="left">47ms</td></tr><tr class="a"><td align="left">nL</td><td align="left">78ms</td><td align="left">78ms</td></tr><tr class="b"><td align="left">nL</td><td align="left">78ms</td><td align="left">78ms</td></tr><tr class="a"><td align="left">nL</td><td align="left">156ms</td><td align="left">156ms</td></tr><tr class="b"><td align="left">nL</td><td align="left">63ms</td><td align="left">63ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">94ms</td><td align="left">94ms</td></tr><tr class="b"><td align="left"><b>Total</b></td><td align="left">4935ms</td><td align="left">4966ms</td></tr></tbody><caption>JAXB context creating and marshalling time before fixing.</caption></table><p>As you can see nearly all the time for marshalling is used to create and particularly recreate the JAXB context. These ten simple commands last almost five seconds and this is the time for marshalling and unmarshalling only.</p></div><div class="section"><h5>Situation after fixing</h5><p>In the <tt>CommandSerializerImpl</tt>, <tt>NotificationChannelEndPoint</tt> and <tt>CommandFactory</tt> class of the proxy and the <tt>Context</tt> class of the core, the context and marshaller are now stored statically and initialised only the first time they are used. This reduces the time needed for marshalling and unmarshalling significantly. The following table shows the same reader configuration with the same method name abbreviations as above.</p><table class="bodyTable"><tbody><tr class="a"><td align="left"><b>method</b></td><td align="left"><b>creating JAXB context</b></td><td align="left"><b>total</b></td></tr><tr class="b"><td align="left">sC</td><td align="left">1279ms</td><td align="left">1326ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">640ms</td><td align="left">640ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">15ms</td><td align="left">15ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">sC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left">gJC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">nL</td><td align="left">312ms</td><td align="left">312ms</td></tr><tr class="a"><td align="left">nL</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">nL</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left">nL</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">nL</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left">nL</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">nL</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left">nL</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">nL</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left">nL</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="b"><td align="left">gJC</td><td align="left">0ms</td><td align="left">0ms</td></tr><tr class="a"><td align="left"><b>Total</b></td><td align="left">2246ms</td><td align="left">2293ms</td></tr></tbody><caption>JAXB context creating and marshalling time after fixing.</caption></table><p>The time for most marshalling and unmarshalling has been reduced to less than one millisecond. Although the amount of time needed to create the JAXB context for the first time is very large, the total time needed for these ten commands is less than half as much as with the previous version. Furthermore the gain increases for every following command and notification which will need less than one millisecond to be marshalled and unmarshalled.</p></div></div><div class="section"><h4>Bugfix <a name="1547776">1547776</a>: Added configuration file for the proxy</h4><p>There is only one property for the timeout to configure in the proxy module, but a configuration file is necessary. Leaving it away and hard coding the value renders it unconfigurable. Merging this single value into an other configuration file is not reasonable. The two possible places would be the log4j configuration file that has nothing to do with the proxy imlementation or a file in an other module that has nothing to do with the proxy too.</p><p>The configuration file of the proxy was missing in the last version 0.3.1 and in the SVN repository. A hard coded value was taken because the file could not be found. So a new configuration file has been added to be able to configure the timeout.</p></div><div class="section"><h4>Bugfix <a name="1773821">1773821</a>: Fixed field name, event and tag field values for custom data selector</h4><p>Using a custom data selector in the proxy did not work and caused a null pointer exception in the reader. The reader configurator of the proxy spuriousle sent the name instead of the value of some constants to the reader. This information is meaningless to the reader and caused the null pointer exception.</p><p>The configurator now sends the value of the <tt>eventFilter</tt>, <tt>fieldName</tt> and <tt>tagField</tt>. Additionally to this, some constant values representing element names of the data selector had to be adjusted to the Reader Protocol specification in the reader core. These were a spelling and some upper and lower case errors.</p></div><div class="section"><h4>Bugfix <a name="1723152">1723152</a>: Renamed TagSelector shorthand from RF to TS</h4><p>Most configuration command elements have a shorthand in the text binding. According to the Reader Protocol specification the shorthand for <tt>TagSelector</tt> is <tt>TS</tt>. This shorthand seemed not to be supported.</p><p>In the serializer of the text message binding of the proxy, there was no difference of the short mode compared to the normal mode for this command. The list of text tokens in the proxy implementation did not contain a constant for the <tt>TS</tt> shorthand. It contained a <tt>RF</tt> constant instead, that does not appear in the Reader Protocol specification. The same error appeared in the <tt>TextCommandParser</tt>, <tt>TextCommandParserTokenTypes</tt> and <tt>TextLexer</tt> classes of the reader core. All these constants have been changed to the correct shorthand <tt>TS</tt> which is now fully supported.</p></div><div class="section"><h4>Bugfix <a name="1782301">1782301</a>: Return error if 'ms=' missing in timer trigger value</h4><p>The 'ms=' at the beginning of the timer trigger value is mandantory according to the Reader Protocol specification. If it was missing and the value consisted of the number representing the time for the trigger only, the reader accepted it but generated errors some commands later when the trigger was used effectively.</p><p>In the <tt>Trigger</tt> class of the reader core the value of the timer trigger is now tested for Reader Protocol compliant format. If the leading 'ms=' is missing, an <tt>ERROR_PARAMETER_INVALID_FORMAT</tt> is returned immediately.</p></div><div class="section"><h4>Bugfix <a name="1782482">1782482</a>: Return notification channel port number correctly</h4><p>Sending a <tt>NotificationChannel.getAddress</tt> command to the reader returned port number 0.</p><p>The <tt>CommandDispatcher</tt> sets the value of the port in the address correctly when the mode of the notification channel is 'connect'. Before returning the address, it overwrites it with the own port which only makes sence when the mode of the notification channel is 'listen'. This has been changed to set the own port only when in listen mode.</p></div><div class="section"><h4>Bugfix <a name="1547832">1547832</a>: Redesigned resource loading</h4><p>Resources such as configuration files caused problems when loaded from a Java archive. When adjusting configuration files to custom needs one had to extract the java archive to replace the default configuration file. This was very inconvenient.</p><p>The whole resource locating and loading mechanism has been redesigned. Locating resources has been centralised in the new utility class <tt>ResourceLocator</tt>. Its public <tt>getURL</tt> method searches for the resource in various places and returnes the absolute URL where to load it. There is no need to create a <tt>ResourceLocator</tt> object because the <tt>getURL</tt> and other methods are static.</p><p>The <tt>getURL</tt> method takes three arguments:</p><ul><li>A resource file name string including the path to the file if needed. The path can be relative or absolute on the file system. This argument is mandantory but can be an empty string.</li><li>A default resource file name string with relative or absolute path as well. This argument is optional and can be <tt>null</tt>. It especially allows in a default setting to search for a custom configuration file with a predefined name before taking the default configuration file that is packed in the Java archive and thus not editable.</li><li>The caller class that helps to find the class loader that best fits the needs of the caller.<p>To get the own class from within an object it is suffisent to call <tt>this.getClass()</tt>. This is very short and can be done directly in the argument list when calling the <tt>getURL</tt> method:</p><div class="source"><pre>URL url = ResourceLocator.getURL(configFile, defaultConfigFile, this.getClass());</pre></div><p>From within a static method it is not easily possible to access the class. One has to take the indirection over an Exception to find the own class name:</p><div class="source"><pre>Exception ex = new Exception();
StackTraceElement[] sTrace = ex.getStackTrace();
String className = sTrace[0].getClassName();
Class clazz = Class.forName(className);
URL url = ResourceLocator.getURL(configFile, defaultConfigFile, clazz);</pre></div></li></ul><p>Locating the resource uses the following approach:</p><ul><li>Try relative to the user directory. This is where the application was started.</li><li>Let the most general class loader try to locate the resource.</li><li>Attempt using the caller class which is able to locate paths relative to the caller package.</li><li>Use the <tt>ClassLoader</tt> class to try getting it as a system resource.</li><li>Try locating the resource on an absolute file path.</li><li>If all these attempts fail the custom resource can not be found and a search for the default resource file is started.</li><li>Depending on the location of the caller class inside or outside a Java archive several locations are searched similar to the custom resource locating.</li></ul><p>This procedure finds the resource in many constellations:</p><ul><li>Relative to the application started or to the library if the module is added as a library (such as the proxy or Fosstrak HAL that uses the same resource loading mechanism).</li><li>With custom or default configuration and without the need of unpacking the java archive.</li><li>On an absolute or relative path.</li></ul></div><div class="section"><h4>Bugfix <a name="1783839">1783839</a>: Send and receive handshake in core and proxy/client</h4><p>With TCP as transport binding the reader did not send back a handshake to the host. The host, proxy or test client did not complain about the missing handshake and the data was sended anyway. In addition to this, the host crashed if it received an answer to the handshake from a Reader Protocol compliant reader.</p><p>Proxy and client now send the handshake immediately after setting up a connection and wait for a response before sending data. The reader answers with a receiver handshake after getting a sender handshake.</p></div><div class="section"><h4>Bugfix <a name="1800577">1800577</a>: Added possibility to start multiple readers on a single computer</h4><p>The bug description was a bit misleading. The graphical test client has nothing to do with the ReaderDevice.xml, this is the configuration for the reader core module. As described in the third paragraph, not the test client causes the error but the reader.</p><p>The problem are not the ports for http, tcp and the alarm channel that can be changed in the configuration file. It is the DHCPServerFinder of the reader management that uses UDP Port 68 (dedicated for dhcp server). Using the same port twice is not possible as intended for multiple instances of the reader on the same system.</p><p>There is no information in the reader documentation saying that it is possible to run multiple instances of the reader on the same system. So on the one hand this is not a bug of the reader, at most a missing feature. On the other hand there is no real solution to this problem as each instance of the reader needs the standard UDP port 68 for the reader management.</p><p>A quickfix of the problem has the following limitations: The first reader instance fully works as usual. Following instances choose an arbitrary port and thus the EPCglobal Reader Management will not work. Furthermore a <tt>java.net.BindExeption</tt> is thrown and shows up in the console. The rest of the reader runs and should work anyway.</p></div><div class="section"><h4>Bugfix <a name="1823580">1823580</a>: No default configuration files defined in other configuration files</h4><p>This bug was introduced after release 0.3.1 and fixed before this next release. The resource locating and loading has been completely redesigned, see <a href="#1547832">bugfix 1547832</a> for more information. The aim was to be able to use the reader with a default or a custom configuration without unpacking the java archive. First, a resource file with a default name or the name given as argument to the main method is searched. If it is not found the default resource file with a different name is loaded. This file is packed in the java archive and a configuration of its name is not needed, so this possibility has been removed from the configuration files.</p></div><div class="section"><h4>Bugfix <a name="1826817">1826817</a>: Iterate over tag field names instead of field names when adding tags to a report in the source</h4><p>Tags are added to the report in the <tt>Source</tt> class of the reader core if they match the data selector. To compare the tag with the data selector a loop iterated over field names instead of tag field names and thus found no match and did not report the tag fields specified in the data selector.</p><p>The comparison has been adjusted accordingly to iterate over the tag field names.</p></div><div class="section"><h4>Bugfix <a name="1827468">1827468</a>: Rewritten byte array to hexadecimal formatted string converter function in the HexUtil class</h4><p>This bug leaded to a wrong tag field value when converting from byte array to hexadecimal encoded string and vice versa. The <tt>HexUtil</tt> helper class in the reader core messaging contained a weak implementationf for these conversions. The result was an extra leading double zero after conversion.</p><p>Both conversion methods have been completely replaced with new implementations that do not cause this problem and work for any length of array or string respectively.</p></div><div class="section"><h4>Bugfix <a name="1827498">1827498</a>: Interprete offset and length of a tag field as bits</h4><p>According to the Reader Protocol specification the unit of the tag field offset and length values is bits. The reader interpreted these as bytes which is wrong.</p><p>Some code has been added to handle the necessary bit manipulation to map the bit values to the bytes containing the specified bits. This includes shifting to the correct bit position and preserving the unaffected bits.</p></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2008
    
          
  

  
    
  
  
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
